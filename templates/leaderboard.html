<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leaderboard ‚Äì Treasure Hunt</title>

<script src="https://unpkg.com/html5-qrcode"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: #2b1d16;
  color: #f2e1c1;
  padding: 0;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

/* HEADER */
.header {
  width: 100%;
  background: #1c120e;
  padding: 14px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 3px solid rgba(198,156,109,0.4);
  box-sizing: border-box;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  margin: 0;
  height: 65px;
}

.header .left-text {
  font-size: 21px;
  font-weight: 700;
  color: #d9b38c;
}

.nav-right a {
  text-decoration: none;
  color: #f2e1c1;
  font-size: 15px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 6px;
}

/* MAIN CONTENT */
.page-wrapper {
  width: 96%;
  max-width: 750px;
  margin-top: 95px;
  margin-left: auto;
  margin-right: auto;
  flex: 1;
}

.board-title {
  font-size: 22px;
  font-weight: 700;
  color: #ffd9b3;
  margin-bottom: 16px;
}

/* TABLE BOX */
.table-box {
  width: 100%;
  background: rgba(255,248,240,0.05);
  border: 2px solid rgba(217,179,140,0.3);
  border-radius: 14px;
  padding: 16px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.6);
  box-sizing: border-box;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 15px;
}

th {
  background: rgba(198,156,109,0.25);
  color: #fff;
  padding: 12px;
  font-size: 16px;
}

td {
  padding: 11px;
  border-bottom: 1px solid rgba(230,201,168,0.12);
  color: #ffe8c9;
  font-weight: 600;
}

.rank { color: #ffcc8c; font-weight: 700; }
.score { color: #8cffb0; font-weight: 700; }

/* FOOTER */
footer {
  text-align: center;
  padding: 13px;
  background: #1a0f0b;
  font-size: 12.5px;
  color: #c69c6d;
  border-top: 2px solid rgba(230,201,168,0.2);
  width: 100%;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 48px;
  box-sizing: border-box;
}

/* RESPONSIVE */
@media (max-width: 480px) {
  .header .left-text { font-size: 17px; }
  .nav-right a { font-size: 14px; }
  table { font-size: 14px; }
}
</style>
</head>

<body>

<div class="header">
  <div class="left-text">Rush Hour Treasure Hunt</div>
  <div class="nav-right">
    <a href="/index"><i class="fa-solid fa-house"></i> Home</a>
  </div>
</div>

<div class="page-wrapper">
  <div class="board-title">üèÜ Leaderboard (Hunt Live)</div>

  <div class="table-box">
    <table id="leaderTable">
      <thead>
        <tr>
          <th>Rank</th>
          <th>Team</th>
          <th>Score</th>
          <th>Last Update</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>
</div>

<footer>¬© 2026 Treasure Hunt | Final Leaderboard</footer>

<script>
async function loadLeaderboard(){
   const res = await fetch("/get_scores");
   const data = await res.json();

   const teams = data.scores;
   let list = [];

   for(const team in teams){
      list.push({
        team: team,
        score: teams[team].score,
        updated_at: teams[team].updated_at,
        login_time: teams[team].login_time
      });
   }

   list.sort((a,b) => b.score - a.score);

   const tbody = document.getElementById("tableBody");
   tbody.innerHTML = "";

   list.forEach((item, i) => {
      tbody.innerHTML += `
        <tr>
          <td class="rank">${i+1}</td>
          <td>${item.team}</td>
          <td class="score">${item.score}</td>
          <td>${item.updated_at || "-"}</td>
        </tr>
      `;
   });
}

loadLeaderboard();
setInterval(loadLeaderboard, 3000);
</script>

</body>
</html>
