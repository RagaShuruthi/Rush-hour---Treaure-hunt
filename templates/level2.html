<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Level 1 ‚Äì Hidden Gateway</title>

<!-- QR Scanner Library -->
<script src="https://unpkg.com/html5-qrcode"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: #2b1d16;
  color: #f2e1c1;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  padding: 14px;
}

.header {
  width: 100%;
  background: #1c120e;
  padding: 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: fixed;
  top: 0;
  left: 0;
  z-index: 1000;
  border-bottom: 2px solid rgba(198,156,109,0.3);
  box-sizing: border-box;
}

.header .left-text {
  font-size: 20px;
  font-weight: 700;
  color: #e6c9a8;
  white-space: nowrap;
}

.nav-right {
  display: flex;
  gap: 20px;
}

.nav-right a {
  text-decoration: none;
  color: #f2e1c1;
  font-size: 16px;
  font-weight: 600;
  transition: 0.3s;
  white-space: nowrap;
}

/* Universal responsiveness for all phones */
@media (max-width: 600px) {
  .header {
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    padding: 10px;
  }

  .header .left-text {
    width: 100%;
    text-align: center;
    font-size: 17px;
  }

  .nav-right {
    justify-content: center;
    width: 100%;
    gap: 14px;
  }

  .nav-right a {
    font-size: 14px;
  }
}

@media (max-width: 360px) {
  .header .left-text {
    font-size: 15px;
  }
  .nav-right a {
    font-size: 12.5px;
  }
}


/* Main content */
.page-wrapper {
  width: 96%;
  max-width: 650px;
  margin: auto;
  flex: 1;
  padding-top: 110px; /* avoid overlap with fixed header */
}

/* Level 1 description */
.level-desc {
  font-size: 22px;
  font-weight: 700;
  color: #d9b38c;
  margin-bottom: 16px;
  text-align: left;
}

.desc-box {
  width: 100%;
  max-width: 650px;
  background: rgba(255,248,240,0.06);
  border: 1px solid rgba(217,179,140,0.3);
  padding: 18px 20px;
  border-radius: 12px;
  font-size: 16px;
  line-height: 1.6;
  text-align: justify;
  opacity: 0.95;
  box-sizing: border-box;
  margin-left: 0;  /* üëà forces it left */
  margin-right: auto; /* keeps only this box left without shifting others */
}


/* Scan button */
.scan-btn {
  padding: 12px 22px;
  font-size: 18px;
  background: #8b5e3c;
  border: none;
  border-radius: 10px;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  margin-bottom: 18px;
  width: 100%;
  max-width: 220px;
  display: block;
}

.scan-btn:hover {
  background: #a97458;
  transform: scale(1.03);
}

/* QR Reader box */
#reader {
  width: 100%;
  max-width: 340px;
  margin: auto;
  border-radius: 12px;
  overflow: hidden;
  border: 2px dashed rgba(217,179,140,0.4);
  background: rgba(0,0,0,0.18);
  padding: 8px;
  display: none;
  min-height: 260px;
}

/* Riddle section */
.riddle-section {
  width: 100%;
  display: none;
  flex-direction: column;
  gap: 18px;
  margin-top: 26px;
}

.riddle-box {
  width: 100%;
  background: rgba(255,248,240,0.05);
  border: 1px solid rgba(217,179,140,0.22);
  padding: 16px;
  border-radius: 10px;
}

.riddle {
  font-size: 17px;
  font-weight: 600;
  color: #ffd9b3;
  margin-bottom: 6px;
}

input {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid rgba(217,179,140,0.3);
  background: rgba(255,255,255,0.1);
  color: #fff;
  outline: none;
}

button.submit-riddle {
  margin-top: 20px;
  padding: 12px;
  font-size: 18px;
  background: #8b5e3c;
  border: none;
  border-radius: 8px;
  color: #fff;
  font-weight: 700;
  cursor: pointer;
  width: 100%;
  max-width: 240px;
  margin-left: auto;
  margin-right: auto;
}

/* Footer */
footer {
  text-align: center;
  padding: 14px;
  background: #1a0f0b;
  font-size: 13px;
  width: 100%;
  color: #c69c6d;
  border-top: 2px solid rgba(230,201,168,0.2);
  margin-top: auto;
}

/* Phone responsive */
@media (max-width: 480px) {
  .header .left-text { font-size: 15px; }
  .nav-right a { font-size: 13px; }
  .level-desc { font-size: 18px; }
  .desc-box { font-size: 14px; padding: 14px 16px; }
  #reader { max-width: 300px; min-height: 230px; }
  .riddle { font-size: 15px; }
  input { font-size: 14px; }
  button.submit-riddle { font-size: 16px; }
  footer { font-size: 11px; }
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
  <div class="left-text">Rush Hour Treasure Hunt</div>
  <div class="nav-right">
    <a href="/index"><i class="fa-solid fa-house"></i> Home</a>
    <a href="/leaderboard"><i class="fa-solid fa-ranking-star"></i> Leaderboard</a>
  </div>
</div>

<!-- MAIN CONTENT -->
<div class="page-wrapper">

  <div class="level-desc">Level 1 ‚Äì The Hidden Gateway</div>

  <div class="desc-box">
    Teams receive an official QR code placed in the event venue. Use this page to scan that QR only. Once verified, 5 riddles will unlock. Solve them all to reveal your Level 2 gateway code. No other QR will be accepted.
  </div><br>

  <!-- Button to start scanning -->
  <center><button class="scan-btn" onclick="startScan()">Scan Official QR</button></center>

  <!-- Camera opens here -->
  <div id="reader"></div>

  <!-- Riddles -->
  <div class="riddle-section" id="riddles">
    <div class="riddle-box"><div class="riddle">1. What runs but never walks?</div><input id="a1"></div>
    <div class="riddle-box"><div class="riddle">2. What shows paths but cannot speak?</div><input id="a2"></div>
    <div class="riddle-box"><div class="riddle">3. What circles the journey but never stops?</div><input id="a3"></div>
    <div class="riddle-box"><div class="riddle">4. What glows at night and warns by day?</div><input id="a4"></div>
    <div class="riddle-box"><div class="riddle">5. What has hands but no arms?</div><input id="a5"></div>

    <button class="submit-riddle" onclick="checkRiddles()">Submit Riddles</button>
  </div>
  

  <div id="level-code" style="display:none;text-align:center;margin-top:22px;font-size:20px;font-weight:700;color:#fff8d2;">
    Level 2 Code: <span id="code-text"></span>
  </div>

</div>

<!-- FOOTER -->
<footer>¬© 2026 Treasure Hunt | Level 1 Challenge</footer>

<script>
function startScan() {
  document.getElementById("reader").style.display = "block";

  const qrCode = new Html5Qrcode("reader");

  qrCode.start(
    { facingMode: "environment" },
    { fps: 10, qrbox: 250 },
    (decodedText) => {
        fetch("/verify_qr", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({ qr: decodedText })
        }).then(res => res.json())
          .then(data => {
            if(data.valid){
               document.getElementById("riddles").style.display = "flex";
            } else {
               alert("‚ùå This is not the official hunt QR!");
            }
          })
        qrCode.stop();
    }
  ).catch(err => {
    alert("Camera permission denied or error ‚ùå");
  });
}

function checkRiddles() {
  let user = [
    document.getElementById("a1").value.trim().toLowerCase(),
    document.getElementById("a2").value.trim().toLowerCase(),
    document.getElementById("a3").value.trim().toLowerCase(),
    document.getElementById("a4").value.trim().toLowerCase(),
    document.getElementById("a5").value.trim().toLowerCase()
  ];

  let correct = ["water", "map", "roundabout", "street lights", "clock"];

  if(JSON.stringify(user) === JSON.stringify(correct)){
     document.getElementById("code-text").innerText = "RUSH-NEXT-91";
     document.getElementById("level-code").style.display = "block";
  } else {
     alert("‚ùå Wrong riddles! Try again.");
  }
}
</script>

</body>
</html>
